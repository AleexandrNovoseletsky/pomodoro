{
  "start_ts": "2025-11-08T20:02:46.154980Z",
  "success": true,
  "error": null,
  "error_traceback": null,
  "created_user_ids": [
    20,
    21,
    22
  ],
  "created_category_ids": [
    26,
    27
  ],
  "created_task_ids": [
    40,
    41,
    42
  ],
  "steps": [
    {
      "ts": "2025-11-08T20:02:46.155560Z",
      "ok": true,
      "message": "Подготовка пользователей в БД...",
      "details": null,
      "request": null,
      "response": null
    },
    {
      "ts": "2025-11-08T20:02:46.988464Z",
      "ok": true,
      "message": "Успешный вход всех трёх пользователей",
      "details": null,
      "request": null,
      "response": null
    },
    {
      "ts": "2025-11-08T20:02:47.047931Z",
      "ok": true,
      "message": "Вход с неверными учётными данными отклонён (ожидаемо)",
      "details": {
        "status_code": 401
      },
      "request": {
        "url": "http://127.0.0.1:8000/users/login",
        "data": {
          "username": "+70000000001",
          "password": "wrong"
        }
      },
      "response": {
        "status_code": 401,
        "text": "{\"error\":\"InvalidCredentials\",\"detail\":\"Неверный логин или пароль.\"}"
      }
    },
    {
      "ts": "2025-11-08T20:02:47.063440Z",
      "ok": true,
      "message": "Root создал категорию",
      "details": {
        "id": 26
      },
      "request": {
        "url": "http://127.0.0.1:8000/categories/",
        "json": {
          "name": "root-cat"
        }
      },
      "response": {
        "status_code": 201
      }
    },
    {
      "ts": "2025-11-08T20:02:47.106782Z",
      "ok": true,
      "message": "Admin создал категорию",
      "details": {
        "id": 27
      },
      "request": null,
      "response": null
    },
    {
      "ts": "2025-11-08T20:02:47.111790Z",
      "ok": true,
      "message": "Создание категории с уже существующим именем отклонено (ожидаемо)",
      "details": null,
      "request": {
        "url": "http://127.0.0.1:8000/categories/",
        "json": {
          "name": "root-cat",
          "is_active": true
        }
      },
      "response": {
        "status_code": 409,
        "text": "{\"error\":\"IntegrityDBError\",\"detail\":\"Объект с таким уникальным значением уже существует.\",\"db_error\":\"<class 'asyncpg.exceptions.uniqueviolationerror'>: duplicate key value violates unique constraint \\\"categories_name_key\\\"\\ndetail:  key (name)=(root-cat) already exists.\"}"
      }
    },
    {
      "ts": "2025-11-08T20:02:47.118293Z",
      "ok": true,
      "message": "Переименование категории на уже существующее имя отклонено (ожидаемо)",
      "details": null,
      "request": {
        "url": "http://127.0.0.1:8000/categories/?category_id=27",
        "json": {
          "name": "root-cat"
        }
      },
      "response": {
        "status_code": 409,
        "text": "{\"error\":\"IntegrityDBError\",\"detail\":\"Объект с таким уникальным значением уже существует.\",\"db_error\":\"<class 'asyncpg.exceptions.uniqueviolationerror'>: duplicate key value violates unique constraint \\\"categories_name_key\\\"\\ndetail:  key (name)=(root-cat) already exists.\"}"
      }
    },
    {
      "ts": "2025-11-08T20:02:47.128475Z",
      "ok": true,
      "message": "Создана задача",
      "details": {
        "phone": "+70000000001",
        "id": 40
      },
      "request": null,
      "response": null
    },
    {
      "ts": "2025-11-08T20:02:47.133813Z",
      "ok": true,
      "message": "Создана задача",
      "details": {
        "phone": "+70000000002",
        "id": 41
      },
      "request": null,
      "response": null
    },
    {
      "ts": "2025-11-08T20:02:47.139330Z",
      "ok": true,
      "message": "Создана задача",
      "details": {
        "phone": "+70000000003",
        "id": 42
      },
      "request": null,
      "response": null
    },
    {
      "ts": "2025-11-08T20:02:47.143829Z",
      "ok": true,
      "message": "Создание задачи с дублирующимся именем отклонено (ожидаемо)",
      "details": null,
      "request": {
        "url": "http://127.0.0.1:8000/tasks/",
        "json": {
          "name": "task-+70000000001",
          "pomodoro_count": 1,
          "category_id": 26,
          "is_active": true
        }
      },
      "response": {
        "status_code": 409,
        "text": "{\"error\":\"IntegrityDBError\",\"detail\":\"Объект с таким уникальным значением уже существует.\",\"db_error\":\"<class 'asyncpg.exceptions.uniqueviolationerror'>: duplicate key value violates unique constraint \\\"tasks_name_key\\\"\\ndetail:  key (name)=(task-+70000000001) already exists.\"}"
      }
    },
    {
      "ts": "2025-11-08T20:02:47.151035Z",
      "ok": true,
      "message": "GET /tasks без авторизации работает (ожидаемо)",
      "details": null,
      "request": null,
      "response": null
    },
    {
      "ts": "2025-11-08T20:02:47.151874Z",
      "ok": true,
      "message": "Создание пользователя с существующим телефоном отклонено (ожидаемо)",
      "details": null,
      "request": {
        "url": "http://127.0.0.1:8000/users/",
        "json": {
          "phone": "+70000000001",
          "first_name": "Dup",
          "last_name": "User",
          "password": "x"
        }
      },
      "response": {
        "status_code": 405,
        "text": "{\"detail\":\"Method Not Allowed\"}"
      }
    },
    {
      "ts": "2025-11-08T20:02:47.155909Z",
      "ok": true,
      "message": "Создание категории с очень длинным именем отклонено (ожидаемо)",
      "details": null,
      "request": {
        "url": "http://127.0.0.1:8000/categories/",
        "json": {
          "name_len": 1025
        }
      },
      "response": {
        "status_code": 422,
        "text": "{\"detail\":[{\"type\":\"string_too_long\",\"loc\":[\"body\",\"name\"],\"msg\":\"String should have at most 30 characters\",\"input\":\"xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx\",\"ctx\":{\"max_length\":30}}]}"
      }
    },
    {
      "ts": "2025-11-08T20:02:47.155921Z",
      "ok": true,
      "message": "E2E: все проверки выполнены (частично).",
      "details": null,
      "request": null,
      "response": null
    }
  ],
  "cleanup": {
    "users": [
      {
        "id": 20,
        "deleted": true
      },
      {
        "id": 21,
        "deleted": true
      },
      {
        "id": 22,
        "deleted": true
      }
    ],
    "categories": [
      {
        "id": 26,
        "deleted": true
      },
      {
        "id": 27,
        "deleted": true
      }
    ],
    "tasks": [
      {
        "id": 40,
        "deleted": true
      },
      {
        "id": 41,
        "deleted": true
      },
      {
        "id": 42,
        "deleted": true
      }
    ]
  },
  "cleanup_human": [
    "Удалено: task id=40",
    "Удалено: task id=41",
    "Удалено: task id=42",
    "Удалено: categorie id=26",
    "Удалено: categorie id=27",
    "Удалено: user id=20",
    "Удалено: user id=21",
    "Удалено: user id=22"
  ],
  "end_ts": "2025-11-08T20:02:47.203300Z"
}