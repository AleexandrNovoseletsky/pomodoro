{
  "start_ts": "2025-11-10T16:00:11.293441+00:00",
  "success": true,
  "error": null,
  "error_traceback": null,
  "created_user_ids": [
    33,
    34,
    35
  ],
  "created_category_ids": [
    35,
    36
  ],
  "created_task_ids": [
    52,
    53,
    54
  ],
  "steps": [
    {
      "ts": "2025-11-10T16:00:11.294050+00:00",
      "ok": true,
      "message": "Подготовка пользователей в БД...",
      "details": null,
      "request": null,
      "response": null
    },
    {
      "ts": "2025-11-10T16:00:11.966833+00:00",
      "ok": true,
      "message": "Успешный вход всех трёх пользователей",
      "details": null,
      "request": null,
      "response": null
    },
    {
      "ts": "2025-11-10T16:00:12.033681+00:00",
      "ok": true,
      "message": "Вход с неверными учётными данными отклонён (ожидаемо)",
      "details": {
        "status_code": 401
      },
      "request": {
        "url": "http://127.0.0.1:8000/users/login",
        "data": {
          "username": "+70000000001",
          "password": "wrong"
        }
      },
      "response": {
        "status_code": 401,
        "text": "{\"error\":\"InvalidCredentials\",\"detail\":\"Неверный логин или пароль.\"}"
      }
    },
    {
      "ts": "2025-11-10T16:00:12.049253+00:00",
      "ok": true,
      "message": "Root создал категорию",
      "details": {
        "id": 35
      },
      "request": {
        "url": "http://127.0.0.1:8000/categories/",
        "json": {
          "name": "root-cat"
        }
      },
      "response": {
        "status_code": 201
      }
    },
    {
      "ts": "2025-11-10T16:00:12.056177+00:00",
      "ok": true,
      "message": "Admin создал категорию",
      "details": {
        "id": 36
      },
      "request": null,
      "response": null
    },
    {
      "ts": "2025-11-10T16:00:12.061267+00:00",
      "ok": true,
      "message": "Создание категории с уже существующим именем отклонено (ожидаемо)",
      "details": null,
      "request": {
        "url": "http://127.0.0.1:8000/categories/",
        "json": {
          "name": "root-cat",
          "is_active": true
        }
      },
      "response": {
        "status_code": 409,
        "text": "{\"error\":\"IntegrityDBError\",\"detail\":\"Объект с таким уникальным значением уже существует.\",\"db_error\":\"<class 'asyncpg.exceptions.uniqueviolationerror'>: duplicate key value violates unique constraint \\\"categories_name_key\\\"\\ndetail:  key (name)=(root-cat) already exists.\"}"
      }
    },
    {
      "ts": "2025-11-10T16:00:12.067796+00:00",
      "ok": true,
      "message": "Переименование категории на уже существующее имя отклонено (ожидаемо)",
      "details": null,
      "request": {
        "url": "http://127.0.0.1:8000/categories/?category_id=36",
        "json": {
          "name": "root-cat"
        }
      },
      "response": {
        "status_code": 409,
        "text": "{\"error\":\"IntegrityDBError\",\"detail\":\"Объект с таким уникальным значением уже существует.\",\"db_error\":\"<class 'asyncpg.exceptions.uniqueviolationerror'>: duplicate key value violates unique constraint \\\"categories_name_key\\\"\\ndetail:  key (name)=(root-cat) already exists.\"}"
      }
    },
    {
      "ts": "2025-11-10T16:00:12.077654+00:00",
      "ok": true,
      "message": "Создана задача",
      "details": {
        "phone": "+70000000001",
        "id": 52
      },
      "request": null,
      "response": null
    },
    {
      "ts": "2025-11-10T16:00:12.083856+00:00",
      "ok": true,
      "message": "Создана задача",
      "details": {
        "phone": "+70000000002",
        "id": 53
      },
      "request": null,
      "response": null
    },
    {
      "ts": "2025-11-10T16:00:12.089209+00:00",
      "ok": true,
      "message": "Создана задача",
      "details": {
        "phone": "+70000000003",
        "id": 54
      },
      "request": null,
      "response": null
    },
    {
      "ts": "2025-11-10T16:00:12.093829+00:00",
      "ok": true,
      "message": "Создание задачи с дублирующимся именем отклонено (ожидаемо)",
      "details": null,
      "request": {
        "url": "http://127.0.0.1:8000/tasks/",
        "json": {
          "name": "task-+70000000001",
          "pomodoro_count": 1,
          "category_id": 35,
          "is_active": true
        }
      },
      "response": {
        "status_code": 409,
        "text": "{\"error\":\"IntegrityDBError\",\"detail\":\"Объект с таким уникальным значением уже существует.\",\"db_error\":\"<class 'asyncpg.exceptions.uniqueviolationerror'>: duplicate key value violates unique constraint \\\"tasks_name_key\\\"\\ndetail:  key (name)=(task-+70000000001) already exists.\"}"
      }
    },
    {
      "ts": "2025-11-10T16:00:12.098973+00:00",
      "ok": true,
      "message": "GET /tasks без авторизации работает (ожидаемо)",
      "details": null,
      "request": null,
      "response": null
    },
    {
      "ts": "2025-11-10T16:00:12.099952+00:00",
      "ok": true,
      "message": "Создание пользователя с существующим телефоном отклонено (ожидаемо)",
      "details": null,
      "request": {
        "url": "http://127.0.0.1:8000/users/",
        "json": {
          "phone": "+70000000001",
          "first_name": "Dup",
          "last_name": "User",
          "password": "x"
        }
      },
      "response": {
        "status_code": 405,
        "text": "{\"detail\":\"Method Not Allowed\"}"
      }
    },
    {
      "ts": "2025-11-10T16:00:12.103606+00:00",
      "ok": true,
      "message": "Создание категории с очень длинным именем отклонено (ожидаемо)",
      "details": null,
      "request": {
        "url": "http://127.0.0.1:8000/categories/",
        "json": {
          "name_len": 1025
        }
      },
      "response": {
        "status_code": 422,
        "text": "{\"detail\":[{\"type\":\"string_too_long\",\"loc\":[\"body\",\"name\"],\"msg\":\"String should have at most 30 characters\",\"input\":\"xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx\",\"ctx\":{\"max_length\":30}}]}"
      }
    },
    {
      "ts": "2025-11-10T16:00:12.103620+00:00",
      "ok": true,
      "message": "E2E: все проверки выполнены (частично).",
      "details": null,
      "request": null,
      "response": null
    }
  ],
  "cleanup": {
    "users": [
      {
        "id": 33,
        "deleted": true
      },
      {
        "id": 34,
        "deleted": true
      },
      {
        "id": 35,
        "deleted": true
      }
    ],
    "categories": [
      {
        "id": 35,
        "deleted": true
      },
      {
        "id": 36,
        "deleted": true
      }
    ],
    "tasks": [
      {
        "id": 52,
        "deleted": true
      },
      {
        "id": 53,
        "deleted": true
      },
      {
        "id": 54,
        "deleted": true
      }
    ]
  },
  "cleanup_human": [
    "Удалено: task id=52",
    "Удалено: task id=53",
    "Удалено: task id=54",
    "Удалено: categorie id=35",
    "Удалено: categorie id=36",
    "Удалено: user id=33",
    "Удалено: user id=34",
    "Удалено: user id=35"
  ],
  "end_ts": "2025-11-10T16:00:12.153160+00:00"
}