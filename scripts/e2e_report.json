{
  "start_ts": "2025-11-12T12:17:37.519392+00:00",
  "success": true,
  "error": null,
  "error_traceback": null,
  "created_user_ids": [
    39,
    40,
    41
  ],
  "created_category_ids": [
    38,
    39
  ],
  "created_task_ids": [
    56,
    57,
    58
  ],
  "steps": [
    {
      "ts": "2025-11-12T12:17:37.519985+00:00",
      "ok": true,
      "message": "Подготовка пользователей в БД...",
      "details": null,
      "request": null,
      "response": null
    },
    {
      "ts": "2025-11-12T12:17:38.417871+00:00",
      "ok": true,
      "message": "Успешный вход всех трёх пользователей",
      "details": null,
      "request": null,
      "response": null
    },
    {
      "ts": "2025-11-12T12:17:38.477096+00:00",
      "ok": true,
      "message": "Вход с неверными учётными данными отклонён (ожидаемо)",
      "details": {
        "status_code": 401
      },
      "request": {
        "url": "http://127.0.0.1:8000/auth/login",
        "data": {
          "username": "+70000000001",
          "password": "wrong"
        }
      },
      "response": {
        "status_code": 401,
        "text": "{\"error\":\"InvalidCredentials\",\"detail\":\"Неверный логин или пароль.\"}"
      }
    },
    {
      "ts": "2025-11-12T12:17:38.493329+00:00",
      "ok": true,
      "message": "Root создал категорию",
      "details": {
        "id": 38
      },
      "request": {
        "url": "http://127.0.0.1:8000/categories/",
        "json": {
          "name": "root-cat"
        }
      },
      "response": {
        "status_code": 201
      }
    },
    {
      "ts": "2025-11-12T12:17:38.498521+00:00",
      "ok": true,
      "message": "Admin создал категорию",
      "details": {
        "id": 39
      },
      "request": null,
      "response": null
    },
    {
      "ts": "2025-11-12T12:17:38.503134+00:00",
      "ok": true,
      "message": "Создание категории с уже существующим именем отклонено (ожидаемо)",
      "details": null,
      "request": {
        "url": "http://127.0.0.1:8000/categories/",
        "json": {
          "name": "root-cat",
          "is_active": true
        }
      },
      "response": {
        "status_code": 409,
        "text": "{\"error\":\"IntegrityDBError\",\"detail\":\"Объект с таким уникальным значением уже существует.\",\"db_error\":\"<class 'asyncpg.exceptions.uniqueviolationerror'>: duplicate key value violates unique constraint \\\"categories_name_key\\\"\\ndetail:  key (name)=(root-cat) already exists.\"}"
      }
    },
    {
      "ts": "2025-11-12T12:17:38.509722+00:00",
      "ok": true,
      "message": "Переименование категории на уже существующее имя отклонено (ожидаемо)",
      "details": null,
      "request": {
        "url": "http://127.0.0.1:8000/categories/?category_id=39",
        "json": {
          "name": "root-cat"
        }
      },
      "response": {
        "status_code": 409,
        "text": "{\"error\":\"IntegrityDBError\",\"detail\":\"Объект с таким уникальным значением уже существует.\",\"db_error\":\"<class 'asyncpg.exceptions.uniqueviolationerror'>: duplicate key value violates unique constraint \\\"categories_name_key\\\"\\ndetail:  key (name)=(root-cat) already exists.\"}"
      }
    },
    {
      "ts": "2025-11-12T12:17:38.521956+00:00",
      "ok": true,
      "message": "Создана задача",
      "details": {
        "phone": "+70000000001",
        "id": 56
      },
      "request": null,
      "response": null
    },
    {
      "ts": "2025-11-12T12:17:38.528096+00:00",
      "ok": true,
      "message": "Создана задача",
      "details": {
        "phone": "+70000000002",
        "id": 57
      },
      "request": null,
      "response": null
    },
    {
      "ts": "2025-11-12T12:17:38.533967+00:00",
      "ok": true,
      "message": "Создана задача",
      "details": {
        "phone": "+70000000003",
        "id": 58
      },
      "request": null,
      "response": null
    },
    {
      "ts": "2025-11-12T12:17:38.538357+00:00",
      "ok": true,
      "message": "Создание задачи с дублирующимся именем отклонено (ожидаемо)",
      "details": null,
      "request": {
        "url": "http://127.0.0.1:8000/tasks/",
        "json": {
          "name": "task-+70000000001",
          "pomodoro_count": 1,
          "category_id": 38,
          "is_active": true
        }
      },
      "response": {
        "status_code": 409,
        "text": "{\"error\":\"IntegrityDBError\",\"detail\":\"Объект с таким уникальным значением уже существует.\",\"db_error\":\"<class 'asyncpg.exceptions.uniqueviolationerror'>: duplicate key value violates unique constraint \\\"tasks_name_key\\\"\\ndetail:  key (name)=(task-+70000000001) already exists.\"}"
      }
    },
    {
      "ts": "2025-11-12T12:17:38.550297+00:00",
      "ok": true,
      "message": "GET /tasks без авторизации работает (ожидаемо)",
      "details": null,
      "request": null,
      "response": null
    },
    {
      "ts": "2025-11-12T12:17:38.551154+00:00",
      "ok": true,
      "message": "Создание пользователя с существующим телефоном отклонено (ожидаемо)",
      "details": null,
      "request": {
        "url": "http://127.0.0.1:8000/users/",
        "json": {
          "phone": "+70000000001",
          "first_name": "Dup",
          "last_name": "User",
          "password": "x"
        }
      },
      "response": {
        "status_code": 405,
        "text": "{\"detail\":\"Method Not Allowed\"}"
      }
    },
    {
      "ts": "2025-11-12T12:17:38.555070+00:00",
      "ok": true,
      "message": "Создание категории с очень длинным именем отклонено (ожидаемо)",
      "details": null,
      "request": {
        "url": "http://127.0.0.1:8000/categories/",
        "json": {
          "name_len": 1025
        }
      },
      "response": {
        "status_code": 422,
        "text": "{\"detail\":[{\"type\":\"string_too_long\",\"loc\":[\"body\",\"name\"],\"msg\":\"String should have at most 30 characters\",\"input\":\"xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx\",\"ctx\":{\"max_length\":30}}]}"
      }
    },
    {
      "ts": "2025-11-12T12:17:38.555087+00:00",
      "ok": true,
      "message": "E2E: все проверки выполнены (частично).",
      "details": null,
      "request": null,
      "response": null
    }
  ],
  "cleanup": {
    "users": [
      {
        "id": 39,
        "deleted": true
      },
      {
        "id": 40,
        "deleted": true
      },
      {
        "id": 41,
        "deleted": true
      }
    ],
    "categories": [
      {
        "id": 38,
        "deleted": true
      },
      {
        "id": 39,
        "deleted": true
      }
    ],
    "tasks": [
      {
        "id": 56,
        "deleted": true
      },
      {
        "id": 57,
        "deleted": true
      },
      {
        "id": 58,
        "deleted": true
      }
    ]
  },
  "cleanup_human": [
    "Удалено: task id=56",
    "Удалено: task id=57",
    "Удалено: task id=58",
    "Удалено: categorie id=38",
    "Удалено: categorie id=39",
    "Удалено: user id=39",
    "Удалено: user id=40",
    "Удалено: user id=41"
  ],
  "end_ts": "2025-11-12T12:17:38.601395+00:00"
}